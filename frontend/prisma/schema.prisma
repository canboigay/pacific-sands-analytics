generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model PaceReport {
  id             String   @id @default(cuid())
  reportDate     DateTime
  targetMonth    String
  roomType       String
  dayOfWeek      Int?
  dayName        String?
  occupancy      Float
  adr            Float
  revenue        Float
  roomsSold      Int
  roomsAvailable Int?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([reportDate, targetMonth])
  @@index([roomType])
}

model OccupancyData {
  id            String   @id @default(cuid())
  snapshotDate  DateTime
  fiscalYear    String
  date          DateTime
  dayOfWeek     String?
  roomType      String?  @default("All")
  available     Int
  sold          Int
  occupancyRate Float
  adr           Float?
  revPAR        Float?
  revenue       Float?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@unique([snapshotDate, date, roomType])
  @@index([date])
  @@index([fiscalYear])
}

model RateShop {
  id           String   @id @default(cuid())
  reportDate   DateTime
  checkInDate  DateTime
  nights       Int?     @default(1)
  property     String
  roomType     String
  ourRate      Float?
  compRate     Float?
  difference   Float?
  percentDiff  Float?
  availability String?
  notes        String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([reportDate, checkInDate])
  @@index([property])
}

model DataImport {
  id          String   @id @default(cuid())
  fileName    String
  filePath    String?
  fileType    String
  fileSize    Int?
  recordCount Int
  importedAt  DateTime @default(now())
  status      String
  errors      Json?
  metadata    Json?

  @@index([fileType, status])
}

model MonthlyMetrics {
  id             String   @id @default(cuid())
  month          DateTime
  fiscalYear     String
  avgOccupancy   Float
  avgAdr         Float
  totalRevenue   Float
  totalRoomsSold Int
  totalAvailable Int
  revPAR         Float
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@unique([month, fiscalYear])
}

model Item {
  id   Int    @id @default(autoincrement())
  name String
}

model GPTInteraction {
  id              String   @id @default(cuid())
  timestamp       DateTime @default(now())
  interactionType String
  endpoint        String
  user            String?  @default("Sandy")
  requestData     Json?
  requestSummary  String?
  responseData    Json?
  responseSummary String?
  responseTime    Int?
  dataPoints      Int?
  confidence      Float?
  category        String?
  tags            String?
  businessValue   String?
  actionTaken     String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@index([timestamp])
  @@index([interactionType])
  @@index([category])
}

model GPTInsight {
  id              String    @id @default(cuid())
  generatedAt     DateTime  @default(now())
  insightType     String
  title           String
  content         String
  summary         String?
  dataSource      String?
  dateRange       String?
  confidence      Float?
  priority        String?   @default("medium")
  actionable      Boolean   @default(true)
  implemented     Boolean   @default(false)
  implementedAt   DateTime?
  outcome         String?
  category        String?
  tags            String?
  potentialImpact String?
  actualImpact    String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@index([generatedAt])
  @@index([insightType])
  @@index([priority])
  @@index([implemented])
}

model GPTUsageSummary {
  id                 String   @id @default(cuid())
  date               DateTime @unique
  totalQueries       Int      @default(0)
  totalResponses     Int      @default(0)
  avgResponseTime    Int?
  analyticsQueries   Int      @default(0)
  forecastQueries    Int      @default(0)
  knowledgeQueries   Int      @default(0)
  insightsStored     Int      @default(0)
  dataPointsAnalyzed Int      @default(0)
  recordsReturned    Int      @default(0)
  keyInsights        Json?
  topQueries         Json?
  businessValue      String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}
